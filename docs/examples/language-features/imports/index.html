<!DOCTYPE html>
<html lang="en">
  
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Typelevel Laika + Helium Theme" />
  <title>Using Imports & Shared Code</title>
  
  
  <meta name="description" content="Scala 3 to GLSL transpiler"/>
  
  
  
  <link rel="icon" sizes="32x32" type="image/png" href="../../../img/favicon.png"/>
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700">
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:500">
  
  <link rel="stylesheet" type="text/css" href="../../../helium/site/icofont.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../helium/site/laika-helium.css" />
    <link rel="stylesheet" type="text/css" href="../../../css/custom.css" />
  <script src="../../../helium/site/laika-helium.js"></script>
  
  
  <script> /* for avoiding page load transitions */ </script>
</head>

  <body>

    <header id="top-bar" class="light-default dark-default">

  <div class="row">
    <a id="nav-icon">
      <i class="icofont-laika navigationMenu" title="Navigation">&#xefa2;</i>
    </a>
    
    
  </div>

  <a class="icon-link glyph-link" href="../../../documentation/"><i class="icofont-laika home" title="Home">&#xef47;</i></a>

  <div class="row links">
    
    <a class="button-link" href="https://purplekingdomgames.github.io/ultraviolet-docs/demos">Live Demos</a>
    
    <a class="button-link" href="https://discord.gg/b5CD47g">Discord</a>
    
    <a class="button-link" href="https://github.com/PurpleKingdomGames/ultraviolet">Github</a>
    
  </div>  

</header>
    
    <nav id="sidebar">

  <div class="row">
    
    <a class="button-link" href="https://purplekingdomgames.github.io/ultraviolet-docs/demos">Live Demos</a>
    
    <a class="button-link" href="https://discord.gg/b5CD47g">Discord</a>
    
    <a class="button-link" href="https://github.com/PurpleKingdomGames/ultraviolet">Github</a>
    
  </div>

  <ul class="nav-list">
    <li class="level1 nav-node"><a href="../../../documentation/">Ultraviolet</a></li>
    <li class="level2 nav-leaf"><a href="../../../documentation/shaders-and-glsl.html">Shaders and GLSL</a></li>
    <li class="level2 nav-leaf"><a href="../../../documentation/motivation.html">Motivation</a></li>
    <li class="level2 nav-node"><a href="../../../documentation/guide/">Writing Shaders</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/guide/scala-vs-glsl.html">Scala 3 vs GLSL</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/guide/premultiplied-alpha.html">Premultiplied Alpha</a></li>
    <li class="level3 nav-leaf"><a href="../../../documentation/guide/gotchas.html">Gotcha&#39;s, foot guns, and weird stuff</a></li>
    <li class="level1 nav-node"><a href="../../">Examples</a></li>
    <li class="level2 nav-node"><a href="../../fragment/">Fragment</a></li>
    <li class="level3 nav-node"><a href="../../fragment/basics/">Basics</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/basics/colour-constants/">Colour Constants</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/basics/colour-interpolators/">Colour Interpolators</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/basics/colours/">Colours</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/basics/minimal/">Minimal Fragment Shader Setup</a></li>
    <li class="level3 nav-node"><a href="../../fragment/demos/">Demos</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/demos/campfire/">Campfire Demo</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/demos/glowing-star/">Glowing Star Demo</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/demos/pulsingbox/">Pulsing Box Demo</a></li>
    <li class="level3 nav-node"><a href="../../fragment/noise/">Noise</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/noise/cellular-noise/">Cellular Noise</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/noise/classic-perlin-noise/">Classic Perlin Noise</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/noise/gradient-noise/">Gradient Noise</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/noise/simplex-noise/">Simplex Noise</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/noise/white-noise/">White Noise</a></li>
    <li class="level3 nav-node"><a href="../../fragment/patterns/">Patterns</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/patterns/grid/">Grid</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/patterns/rainbow/">Rainbow</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/patterns/simple-voronoi/">Voronoi Example</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/patterns/stripes/">Stripes</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/patterns/wavy-stripes/">Wavy stripes</a></li>
    <li class="level3 nav-node"><a href="../../fragment/sdf/">Sdf</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/sdf/box/">Square SDF</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/sdf/circle/">Circle SDF</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/sdf/hexagon/">Hexagon SDF</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/sdf/segment/">Segment SDF</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/sdf/star/">Star SDF</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/sdf/triangle/">Triangle SDF</a></li>
    <li class="level3 nav-node"><a href="../../fragment/shapes/">Shapes</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/shapes/doughnut/">Doughnut</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/shapes/metaballs/">Metaballs</a></li>
    <li class="level3 nav-node"><a href="../../fragment/textures/">Textures</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/textures/basic-texture-use/">Basic texture use</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/textures/blending-textures/">Blending Textures</a></li>
    <li class="level4 nav-leaf"><a href="../../fragment/textures/specifying-texture-coords/">Specifying Texture Coordinates</a></li>
    <li class="level2 nav-node"><a href="../">Language-features</a></li>
    <li class="level3 active nav-leaf"><a href="#">Using Imports &amp; Shared Code</a></li>
    <li class="level3 nav-leaf"><a href="../ubos/">Supplying Data with UBOs</a></li>
    <li class="level2 nav-node"><a href="../../vertex/">Vertex</a></li>
    <li class="level3 nav-leaf"><a href="../../vertex/manipulatinguvs/">Manipulating UVs</a></li>
    <li class="level3 nav-leaf"><a href="../../vertex/minimal/">Minimal Vertex Shader Setup</a></li>
    <li class="level3 nav-leaf"><a href="../../vertex/movingvertices/">Moving Vertices</a></li>
  </ul>

</nav>

    <div id="container">

      
<nav id="page-nav">
  <p class="header"><a href="#">Using Imports &amp; Shared Code</a></p>

  <ul class="nav-list">
    <li class="level1 nav-leaf"><a href="#example-links">Example Links</a></li>
    <li class="level1 nav-node"><a href="#how-to-import-shared-code">How to import shared code</a></li>
    <li class="level2 nav-leaf"><a href="#shared-code">Shared code</a></li>
  </ul>

  <p class="footer"></p>
</nav>


      <main class="content">

        <h1 id="using-imports-shared-code" class="title">Using Imports &amp; Shared Code</h1>
        <p>Imports and shared code are not entirely straight forward to use with Ultraviolet.</p>
        <p>Please see <a href="../../../documentation/guide/">the main docs on writing shaders and code reuse</a> for more information.</p>
        
        <h2 id="example-links" class="section"><a class="anchor-link left" href="#example-links"><i class="icofont-laika link">&#xef71;</i></a>Example Links</h2>
        <ul>
          <li><a href="https://github.com/PurpleKingdomGames/ultraviolet-docs/blob/main/examples/language-features/imports">View example code</a></li>
        </ul>
        <ul>
          <li><a href="https://purplekingdomgames.github.io/ultraviolet-docs//demos/examples/language-features/imports/">Live demo</a></li>
        </ul>
        
        <h2 id="how-to-import-shared-code" class="section"><a class="anchor-link left" href="#how-to-import-shared-code"><i class="icofont-laika link">&#xef71;</i></a>How to import shared code</h2>
        
        <h3 id="shared-code" class="section"><a class="anchor-link left" href="#shared-code"><i class="icofont-laika link">&#xef71;</i></a>Shared code</h3>
        <p>First we&#39;ll declare some contrived code that we&#39;re pretending we&#39;d like to use in multiple
        shaders.</p>
        <p>There are some important things to note about this small section of code.</p>
        <ol class="arabic">
          <li>
            <p>We&#39;ve imported <code>ultraviolet.syntax.*</code>. Recall that, unfortunately, both Indigo and
            Ultraviolet both have types called things like <code>vec2</code>, <code>vec4</code>, etc. This import is to
            ensure that we&#39;re using the Ultraviolet types. In this specific example the import is done
            inside the object because indigo is imported at the top, but if the code was in a separate
            class then you could just put the import at the top as usual.</p>
          </li>
          <li>
            <p>All the fields and functions are declared as <code>inline</code>. This is because Ultraviolet is
            implemented with inline macros, and if the code isn&#39;t inlined, then Ultraviolet can&#39;t see it.</p>
          </li>
          <li>
            <p><code>redAmount</code> looks like it should be a <code>val</code>... and indeed normally it would be. However,
            <code>val</code> declarations do not work, so we have to use <code>inline def</code> instead.</p>
          </li>
        </ol>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">object</span><span> </span><span class="type-name">SharedCode</span><span>:
  </span><span class="keyword">import</span><span> </span><span class="identifier">ultraviolet</span><span>.</span><span class="identifier">syntax</span><span>.*

  </span><span class="identifier">inline</span><span> </span><span class="keyword">def</span><span> </span><span class="declaration-name">redAmount</span><span>: </span><span class="type-name">Float</span><span>       = </span><span class="number-literal">0.5</span><span>
  </span><span class="identifier">inline</span><span> </span><span class="keyword">def</span><span> </span><span class="declaration-name">grabX</span><span>(</span><span class="identifier">uv</span><span>: </span><span class="identifier">vec2</span><span>): </span><span class="type-name">Float</span><span> = </span><span class="identifier">uv</span><span>.</span><span class="identifier">x</span></code></pre>
        <p>Within our custom shader object, we can import the shared code and use it in our shader, but
        we can&#39;t do things like <code>SharedCode.redAmount</code> at the present time.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="type-name">SharedCode</span><span>.* </span><span class="comment">// This is okay.
// SharedCode.redAmount // This does not work.</span></code></pre>
        <p>Another unfortunate limitation is that we cannot use our grabX function directly. The code
        will compile if you try to use it, but your shader will be black, and if you check your
        browser console you&#39;ll see a mysterious error, like this:</p>
        <p><code>[Indigo] ERROR: 0:72: &#39;constructor&#39; : too many arguments</code></p>
        <p>In order to use the grabX function, we need to assign it to a proxy/delegate function
        within the scope of the shader.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">val</span><span> </span><span class="identifier">proxyGrabX</span><span>: </span><span class="identifier">vec2</span><span> =&gt; </span><span class="type-name">Float</span><span> = </span><span class="identifier">uv</span><span> =&gt; </span><span class="identifier">grabX</span><span>(</span><span class="identifier">uv</span><span>)</span></code></pre>
        <p>Finally, we can see the shared code in use.</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">def</span><span> </span><span class="declaration-name">fragment</span><span>(</span><span class="identifier">color</span><span>: </span><span class="identifier">vec4</span><span>): </span><span class="identifier">vec4</span><span> =
  </span><span class="identifier">vec4</span><span>(</span><span class="identifier">redAmount</span><span>, </span><span class="identifier">proxyGrabX</span><span>(</span><span class="identifier">env</span><span>.</span><span class="type-name">UV</span><span>), </span><span class="number-literal">0.0f</span><span>, </span><span class="number-literal">1.0f</span><span>)</span></code></pre>

        
<hr class="footer-rule"/>
<footer>
  Site generated by <a href="https://typelevel.org/Laika/">Laika</a> with the Helium theme.
</footer>


      </main>

    </div>

  </body>

</html>